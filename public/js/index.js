(()=>{"use strict";var e={d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{cC:()=>x,AW:()=>F,Ow:()=>j,Sk:()=>V,yB:()=>W});const t=5;let a,n=t;function o(e=null,t=null){const a=e?e.target.getAttribute("data-modal"):t,o=document.getElementById(a);o.classList.remove("hidden"),n=6e4*parseFloat(o.getAttribute("data-timeout")),l()}function r(e){clearTimeout(a);const t=e.target.getAttribute("data-dismiss");document.getElementById(t).classList.add("hidden")}function l(){clearTimeout(a),a=setTimeout((function(){document.querySelectorAll(".modal:not(.timeout-exempt)").forEach((e=>{e.classList.add("hidden")}))}),n)}let c,s,i,u=0;function d(){clearTimeout(s),s=setTimeout((()=>{document.getElementById("maintenance").classList.add("hidden")}),3e5)}function m(e){u<4&&u++,3===u&&(document.getElementById("maintenance").classList.remove("hidden"),d()),clearTimeout(c),c=setTimeout((()=>{u=0}),1e3)}function p(e,t){let a=Object.keys(t);for(let n=0;n<a.length;n++)e.hasOwnProperty(a[n])?"object"==typeof e[a[n]]&&(e[a[n]]=p(e[a[n]],t[a[n]])):e[a[n]]=t[a[n]];return e}function v(e,t){const a=Object.keys(e)[0];return t.hasOwnProperty(a)?"object"==typeof e[a]?v(e[a],t[a]):{value:t[a],parentObject:t}:(console.log(`obj does not match the path: ${e}`),!1)}function h(e){var t=parseInt(e.innerHTML);e.innerHTML=t-1,i=setTimeout((function(){t>1?h(e):clearTimeout(i)}),1e3)}function g(e,t,a="warming",n){e.classList.add(a),e.setAttribute("style",`--duration:${t}s;`),e.classList.remove("hidden"),setTimeout((function(){e.classList.add("hidden"),e.classList.remove("warming"),e.classList.remove("cooling"),n()}),1e3*t)}function y(e){var t=e.target;t.classList.add("active");const a=t.getAttribute("data-value");W(t.parentElement.getAttribute("data-path").replace(/<value>/,a),null)}function f(e){var t=e.target;t.classList.remove("active");const a=['"left"','"right"','"up"','"down"'].includes(t.getAttribute("data-value"))?'"pan stop"':'"zoom stop"';W(t.parentElement.getAttribute("data-path").replace(/<value>/,a),null)}function b(e){var t=e.target;t.removeEventListener("click",b),t.removeEventListener("touchstart",b),t.classList.add("active");const a=!t.getAttribute("data-value")||t.getAttribute("data-value");W(t.getAttribute("data-path").replace(/<value>/,a),(function(){t.classList.remove("active"),t.addEventListener("click",b),t.addEventListener("touchstart",b)}))}function E(e,t,a){!0===t&&"true"!==e.getAttribute("data-override")?e.classList.add("active"):e.classList.remove("active"),e.setAttribute("data-value",t),e.hasAttribute("data-allow-events")&&(e.addEventListener("click",a),e.addEventListener("touchstart",a))}function L(e){var t=e.target;t.removeEventListener("click",L),t.removeEventListener("touchstart",L),t.removeAttribute("data-allow-events");const a="true"!==t.getAttribute("data-value");E(t,a,L);const n=t.getAttribute("data-path");W(n.replace(/<value>/,a),(function(e){let a=v(JSON.parse(n.replace(/<value>/,'""')),e);t.setAttribute("data-allow-events",""),E(t,a.value,L)}))}function A(e,t){!0===t?(e.classList.add("active"),e.querySelector(".slash").classList.remove("hidden"),e.querySelector(".button-label").innerHTML="Show video"):(e.classList.remove("active"),e.querySelector(".slash").classList.add("hidden"),e.querySelector(".button-label").innerHTML="Hide video"),e.setAttribute("data-value",t),e.hasAttribute("data-allow-events")&&(e.addEventListener("click",S),e.addEventListener("touchstart",S));const a=e.getAttribute("data-channel");a&&document.querySelectorAll(`.display-source-radio[data-channel='${a}'] .radio-option`).forEach((e=>{const t="true"===e.getAttribute("data-value");T(e,t)}))}function S(e){const t=e.target,a="true"!==t.getAttribute("data-value"),n=t.getAttribute("data-path"),o=n.replace(/<value>/,a);t.removeEventListener("click",S),t.removeEventListener("touchstart",S),t.removeAttribute("data-allow-events"),A(t,a),W(o,(function(e){const a=v(JSON.parse(n.replace(/<value>/,'""')),e);t.setAttribute("data-allow-events",""),A(t,a.value)}))}const w=60;function _(e,t){E(e,t,q);const a=e.getAttribute("data-channel");a&&document.querySelectorAll(`.pause-button[data-channel='${a}']`).forEach((e=>{!0===t?e.classList.remove("invisible"):e.classList.add("invisible")})),a&&document.querySelectorAll(`.display-source-radio[data-channel='${a}'] .radio-option`).forEach((e=>{const t="true"===e.getAttribute("data-value");T(e,t)}))}function q(e){const t=e.target,a="true"!==t.getAttribute("data-value"),n=t.getAttribute("data-path");let o=n.replace(/<value>/,a);const r=!!t.getAttribute("data-channel")&&t.getAttribute("data-channel"),l=!!r&&document.querySelectorAll(`.display-source-radio[data-channel='${r}'] .radio-option`),c=document.getElementById("shutdown-confirmation");let s;function u(){clearTimeout(s),clearTimeout(i),c.classList.add("hidden"),c.querySelector("button[name=shutdown]").removeEventListener("click",m),c.querySelector("button[name=shutdown]").removeEventListener("touchstart",m),c.querySelector("button[name=cancel]").removeEventListener("click",u),c.querySelector("button[name=cancel]").removeEventListener("touchstart",u)}function d(e){clearTimeout(s),clearTimeout(i);const o=v(JSON.parse(n.replace(/<value>/,'""')),e),c=!!t.getAttribute("data-duration")&&parseInt(t.getAttribute("data-duration"));c&&o.value===a?(!0===o.value&&r&&l.forEach((e=>{e.setAttribute("data-allow-events","")})),g(t.parentElement.parentElement.querySelector(".progress"),c,!0===a?"warming":"cooling",(function(){t.setAttribute("data-allow-events",""),t.addEventListener("click",q),t.addEventListener("touchstart",q),r&&l.forEach((e=>{e.setAttribute("data-allow-events",""),e.addEventListener("click",I),e.addEventListener("touchstart",I)}))}))):(t.setAttribute("data-allow-events",""),r&&l.forEach((e=>{e.setAttribute("data-allow-events","")}))),_(t,o.value),r&&(l.forEach((t=>{const a=JSON.parse(t.getAttribute("data-path").replace(/<value>/,!0));T(t,v(a,e).value)})),document.querySelectorAll(`.pause-button[data-channel='${r}']`).forEach((t=>{const a=v(JSON.parse(t.getAttribute("data-path").replace(/<value>/,!0)),e);t.setAttribute("data-allow-events",""),A(t,a)}))),u()}function m(){t.removeEventListener("click",q),t.removeEventListener("touchstart",q),t.removeAttribute("data-allow-events"),r&&(document.querySelectorAll(`.pause-button[data-channel='${r}']`).forEach((e=>{e.removeEventListener("click",S),e.removeEventListener("touchstart",S),e.removeAttribute("data-allow-events")})),l.forEach((e=>{e.removeEventListener("click",I),e.removeEventListener("touchstart",I),e.removeAttribute("data-allow-events")}))),c.querySelector("button[name=shutdown]").removeEventListener("click",m),c.querySelector("button[name=shutdown]").removeEventListener("touchstart",m),t.classList.toggle("active"),W(o,d)}!0===a?(r&&document.querySelectorAll(`.display-source-radio[data-channel='${r}']`).forEach((e=>{let t=e.getAttribute("data-default-option");"last_selected"===t&&(t=!!e.querySelector("[data-value=true]")&&e.querySelector("[data-value=true]").getAttribute("data-option")),t&&e.querySelector(`[data-option=${t}]`)||(t=e.querySelector(".radio-option").getAttribute("data-option"));const a=e.querySelector(`[data-option=${t}]`).getAttribute("data-path").replace(/<value>/,!0);let n=p(JSON.parse(o),JSON.parse(a));o=JSON.stringify(n)})),m()):(c.querySelector(".counter").innerHTML=w,h(c.querySelector(".counter")),c.querySelector(".projector-name").textContent=t.getAttribute("data-channel-name"),c.querySelector("button[name=shutdown]").addEventListener("click",m),c.querySelector("button[name=shutdown]").addEventListener("touchstart",m),c.querySelector("button[name=cancel]").addEventListener("click",u),c.querySelector("button[name=cancel]").addEventListener("touchstart",u),c.classList.remove("hidden"),s=setTimeout(m,1e3*w+100))}function T(e,t){const a=e.parentElement,n=a.getAttribute("data-channel"),o="true"===e.getAttribute("data-zoom-room-controller"),r="true"===e.getAttribute("data-zoom-share-screen-modal-launcher");let l=!1;if(n&&(document.querySelector(`.power-button[data-channel=${n}]`)&&"false"===document.querySelector(`.power-button[data-channel=${n}]`).getAttribute("data-value")||document.querySelector(`.pause-button[data-channel=${n}]`)&&"true"===document.querySelector(`.pause-button[data-channel=${n}]`).getAttribute("data-value")?(e.setAttribute("data-override","true"),l=!0):e.setAttribute("data-override","false")),!l&&(o||r)){const t=o?a.querySelector("[data-zoom-share-screen-modal-launcher=true]"):a.querySelector("[data-zoom-room-controller=true]");"false"===e.getAttribute("data-selected-zoom-input")?e.setAttribute("data-override","true"):"true"===e.getAttribute("data-selected-zoom-input")?e.setAttribute("data-override","false"):t&&"true"!==t.getAttribute("data-selected-zoom-input")&&(a.querySelector("[data-zoom-room-controller=true]")?(a.querySelector("[data-zoom-room-controller=true]").setAttribute("data-selected-zoom-input","true"),a.querySelector("[data-zoom-share-screen-modal-launcher=true]").setAttribute("data-selected-zoom-input","false"),r&&e.setAttribute("data-override","true")):(e.setAttribute("data-selected-zoom-input","true"),e.setAttribute("data-override","false")))}E(e,t,I)}function I(e){const t=e.target,a=t.parentElement;if(!t.classList.contains("active")){let n=!1,o=!1;function r(e){if(a.querySelectorAll(".radio-option").forEach((t=>{const a=t.getAttribute("data-path");let n=v(JSON.parse(a.replace(/<value>/,'""')),e);t.setAttribute("data-allow-events",""),T(t,n.value)})),o&&document.querySelectorAll(`.pause-button[data-channel='${c}']`).forEach((t=>{const a=t.getAttribute("data-path");let n=v(JSON.parse(a.replace(/<value>/,'""')),e);t.setAttribute("data-allow-events",""),setVideoMuteButtonState(t,n.value)})),n){function t(e,t){e.setAttribute("data-allow-events",""),_(e,t)}document.querySelectorAll(`.power-button[data-channel='${c}']`).forEach((a=>{const n=v(JSON.parse(a.getAttribute("data-path").replace(/<value>/,'""')),e);if(n.value&&a.getAttribute("data-duration")){const e=parseInt(a.getAttribute("data-duration"));g(a.parentElement.parentElement.querySelector(".progress"),e,"warming",(function(){t(a,n.value)}))}else t(a,n.value)}))}}a.querySelectorAll(".radio-option").forEach((function(e){e.removeEventListener("click",I),e.removeEventListener("touchstart",I),e.removeAttribute("data-allow-events")})),null!==a.querySelector("[data-value=true]")&&T(a.querySelector("[data-value=true]"),!1),T(t,!0);let l=t.getAttribute("data-path").replace(/<value>/,!0);const c=t.parentElement.getAttribute("data-channel");c&&(document.querySelectorAll(`.power-button[data-channel='${c}']`).forEach((e=>{if("false"===e.getAttribute("data-value")){const t=e.getAttribute("data-path").replace(/<value>/,!0);let a=p(JSON.parse(t),JSON.parse(l));l=JSON.stringify(a),e.removeEventListener("click",q),e.removeEventListener("touchstart",q),e.removeAttribute("data-allow-events"),_(e,!0),n=!0}})),document.querySelectorAll(`.pause-button[data-channel='${c}']`).forEach((e=>{if("true"===e.getAttribute("data-value")){const t=e.getAttribute("data-path").replace(/<value>/,!1);let a=p(JSON.parse(l),JSON.parse(t));l=JSON.stringify(a),e.removeEventListener("click",handleVideoMute),e.removeEventListener("touchstart",handleVideoMute),e.removeAttribute("data-allow-events"),setVideoMuteButtonState(e,!1),o=!0}}))),W(l,r)}}function $(e,t){const a="true"===e.getAttribute("data-muted")?"var(--slider-muted)":"var(--theme-color)";t=t&&parseInt(t)?t:0,e.value=t,e.setAttribute("style",`background:linear-gradient(to right, ${a}, ${a} ${t}%, var(--slider-muted) ${t}%, var(--slider-muted))`),e.hasAttribute("data-allow-events")&&e.addEventListener("input",M)}var B=!1;function M(e,t=!1){const a=e.target;window.clearTimeout(j);const n=parseInt(a.getAttribute("data-timer"));window.clearTimeout(x[n]),t||$(a,a.value),!1===B?(B=!0,W(a.getAttribute("data-path").replace(/<value>/,a.value),(function(){B=!1}))):x[n]=setTimeout((function(){M(e,!0)}),200)}function O(e,t){!0===t?(e.classList.remove("active"),e.querySelector(".slash").classList.remove("hidden")):(e.classList.add("active"),e.querySelector(".slash").classList.add("hidden")),e.setAttribute("data-value",t),e.hasAttribute("data-allow-events")&&(e.addEventListener("click",H),e.addEventListener("touchstart",H)),e.getAttribute("data-channel")&&document.querySelectorAll(`.slider[data-channel='${e.getAttribute("data-channel")}']`).forEach((e=>{e.setAttribute("data-muted",t),$(e,e.value)}))}function H(e){var t=e.target;t.removeEventListener("click",H),t.removeEventListener("touchstart",H),t.removeAttribute("data-allow-events");const a="true"!==t.getAttribute("data-value");O(t,a);const n=t.getAttribute("data-path");W(n.replace(/<value>/,a),(function(e){let a=v(JSON.parse(n.replace(/<value>/,'""')),e);t.setAttribute("data-allow-events",""),O(t,a.value)}))}function k(e){const t=e.target,a=t.parentElement;t.classList.contains("active")||(a.querySelectorAll(".radio-option").forEach((function(e){e.removeEventListener("click",k),e.removeEventListener("touchstart",k),e.removeAttribute("data-allow-events")})),null!==a.querySelector("[data-value=true]")&&E(a.querySelector("[data-value=true]"),!1,k),E(t,!0,k),W(t.getAttribute("data-path").replace(/<value>/,!0),(function(e){a.querySelectorAll(".radio-option").forEach((t=>{const a=t.getAttribute("data-path");let n=v(JSON.parse(a.replace(/<value>/,'""')),e);t.setAttribute("data-allow-events",""),E(t,n.value,k)}))})))}let J,N,j,z={state:"initializing",orchestrator:null,system:null};window.onerror=function(e,t,a,n){return console.error(`Javascript runtime error: ${e} \nFrom ${t}, line ${a} col ${n}`),async function(e){const t=z.orchestrator;await F(`${t}/api/errors/client`,{method:"POST",body:JSON.stringify({message:e,code:"84hfn3jd7h4n",severity:1})}).catch((e=>{console.error("Error in function throwClientError: ",e)}))}(`Javascript runtime error: ${e} \nFrom ${t}, line ${a} col ${n}\nLast get_status: ${z.state?JSON.stringify(z.state):z.state}`),!0};let P=!1,C=2;const x=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0];let R=0;function V(e,t,a,n,o={half_width:!1,justify_content:!1}){let r=document.getElementById(`${t.icon}-icon-template`)?document.getElementById(`${t.icon}-icon-template`).innerHTML:"",l=""===r?"no-icon":"";const c=t.hasOwnProperty("name")?t.name:e;let s=document.getElementById("generic-control-set-template").innerHTML.replace(/{{icon}}/g,r).replace(/{{no-icon}}/g,l).replace(/{{id}}/g,e).replace(/{{control_set_name}}/g,c);const i=document.getElementById(n);i.insertAdjacentHTML("beforeend",s);const u=i.lastElementChild;o.half_width&&u.classList.add("half-width"),o.justify_content&&u.classList.add("justify-content");for(const e in t.controls){const n=t.controls[e]?.type;n||console.error("No type specified for "+e);const o=a.replace(/<id>/g,e),s=t.controls[e].hasOwnProperty("channel")?t.controls[e].channel:"";let i;if("stateless_mute"===n&&(i=document.getElementById("mute-button-template").innerHTML.replace(/{{path}}/g,o).replace(/{{control_set}}/g,c).replace(/{{muteState}}/g,"")),"stateless_volume"===n&&(i=document.getElementById("stateless-volume-control-template").innerHTML.replace(/{{path}}/g,o).replace(/{{control_set}}/g,c)),"generic_toggle"===n&&(r=document.getElementById(`${t.controls[e].icon}-icon-template`)?document.getElementById(`${t.controls[e].icon}-icon-template`).innerHTML:"",l=""===r?"no-icon":"",i=document.getElementById("generic-button-template").innerHTML.replace(/{{path}}/g,o).replace(/{{name}}/g,t.controls[e].name).replace(/{{icon}}/g,r).replace(/{{no-icon}}/g,l).replace(/{{enabled}}/g,t.controls[e].value)),"mute"===n&&(i=document.getElementById("mute-button-template").innerHTML.replace(/{{control_set}}/g,c).replace(/{{path}}/g,o).replace(/{{channel}}/g,s).replace(/{{muteState}}/g,t.controls[e].value)),"volume"===n&&(i=document.getElementById("volume-control-template").innerHTML.replace(/{{control_set}}/g,c).replace(/{{path}}/g,o).replace(/{{channel}}/g,s).replace(/{{timerId}}/g,R),R++),"power"===n){const a=t.controls[e].hasOwnProperty("name")?t.controls[e].name:"Power",n=t.controls[e].hasOwnProperty("channel_name")?t.controls[e].channel_name:"",r=!!t.controls[e].hasOwnProperty("warmup_timer")&&t.controls[e].warmup_timer;i=document.getElementById("power-button-template").innerHTML.replace(/{{path}}/g,o).replace(/{{channel}}/g,s).replace(/{{name}}/g,a).replace(/{{channel_name}}/g,n).replace(/{{control_set}}/g,c).replace(/{{duration}}/g,r).replace(/{{value}}/g,t.controls[e].value)}if("video_mute"===n&&(i=document.getElementById("video-pause-template").innerHTML.replace(/{{path}}/g,o).replace(/{{channel}}/g,s).replace(/{{control_set}}/g,c).replace(/{{value}}/g,t.controls[e].value)),"radio"===n||"camera_preset_radio"===n||"display_source_radio"===n||"input_select"===n){let a=t.controls[e].hasOwnProperty("default_option")?t.controls[e].default_option:"";t.controls[e].hasOwnProperty("default_input")&&(a=t.controls[e].default_input);let r="camera_preset_radio"===n?"camera-preset-radio":"";"display_source_radio"!==n&&"input_select"!==n||(r="display-source-radio");const l=document.getElementById("radio-control-template").innerHTML.replace(/{{path}}/g,o.replace(/\"value\"/,'"options"')).replace(/{{channel}}/g,s).replace(/{{defaultOption}}/g,a).replace(/{{class}}/g,r),u=document.getElementById("radio-option-template").innerHTML;let d="";for(const a in t.controls[e].options){let n=document.getElementById(`${t.controls[e].options[a].icon}-icon-template`)?document.getElementById(`${t.controls[e].options[a].icon}-icon-template`).innerHTML:"",r=""===n?"no-icon":"";const l=o.replace(/\"value\"/,'"options"').replace(/<value>/,`{"${a}":{"value":<value>}}`);d+=u.replace(/{{path}}/g,l).replace(/{{name}}/g,t.controls[e].options[a].name).replace(/{{icon}}/g,n).replace(/{{no-icon}}/g,r).replace(/{{control_set}}/g,c).replace(/{{option}}/g,a).replace(/{{value}}/g,t.controls[e].options[a].value)}i=l.replace(/{{options}}/,d)}"pan_tilt"===n&&(i=document.getElementById("pan-tilt-template").innerHTML.replace(/{{name}}/g,t.controls[e].name).replace(/{{path}}/g,o)),"camera_zoom"===n&&(i=document.getElementById("camera-zoom-template").innerHTML.replace(/{{name}}/g,t.controls[e].name).replace(/{{path}}/g,o)),"modal_launcher"===n&&(r=document.getElementById(`${t.controls[e].icon}-icon-template`)?document.getElementById(`${t.controls[e].icon}-icon-template`).innerHTML:"",l=""===r?"no-icon":"",i=document.getElementById("modal-launcher-button-template").innerHTML.replace(/{{icon}}/g,r).replace(/{{no-icon}}/g,l).replace(/{{name}}/g,t.controls[e].name).replace(/{{modal}}/g,t.controls[e].modal)),u.querySelector(".controls-wrapper").insertAdjacentHTML("beforeend",i)}}function D(){return console.log("failover placeholder"),!1}async function F(e,t){return window.clearTimeout(j),fetch(e,{...t,signal:AbortSignal.timeout(5e3)}).then((a=>200===a.status?(C=2,j=window.setTimeout(U,5e3),a.json()):204===a.status||404===a.status?(document.getElementById("main-controls").innerHTML="",document.getElementById("advanced-modals-container").innerHTML="",document.getElementById("room-name").innerHTML="",document.getElementById("room-header").classList.add("hidden"),document.getElementById("message").innerHTML=204===a.status?"<p>System initializing ...</p>":"<p>Could not find system</p>",document.getElementById("message").classList.remove("hidden"),C=2,j=window.setTimeout(U,5e3),!1):400===a.status?(a.json().then((e=>{console.log("Bad request: ",e)})),j=window.setTimeout(U,5e3),!1):C>0?(C--,F(e,t)):D())).catch((a=>(console.log(a),C>0?(C--,F(e,t)):D())))}async function U(){const e=await F(`${J}/api/systems/${N}/state`);if(e){z.state=e,document.getElementById("message").classList.add("hidden"),document.getElementById("room-name").innerHTML=e.system_name,document.getElementById("room-header").classList.remove("hidden"),document.getElementById("maintenance").querySelector("pre").innerHTML=JSON.stringify(e,null,4),document.getElementById("maintenance").querySelector(".timestamp").innerHTML=new Date;let n=!document.getElementById("main-controls").innerHTML;if(n&&e.control_sets)for(const t in e.control_sets){let a=`{"control_sets":{"${t}":{"controls":{"<id>":{"value":<value>}}}}}`,n={half_width:!1,justify_content:!1};if(e.control_sets[t].display_options)for(let a in e.control_sets[t].display_options)n[a]=e.control_sets[t].display_options[a];V(t,e.control_sets[t],a,"main-controls")}n&&e.modals&&function(e){for(const a in e)if(!document.getElementById(a)){const n=e[a].timeout_timer?e[a].timeout_timer:t;let o=document.getElementById("advanced-modal-template").innerHTML.replace(/{{modalId}}/g,a).replace(/{{title}}/g,e[a].name).replace(/{{timeoutDuration}}/g,n);document.getElementById("advanced-modals-container").insertAdjacentHTML("beforeend",o);for(const t in e[a].control_sets){const n=`{"modals":{"${a}":{"control_sets":{"${t}":{"controls":{"<id>":{"value":<value>}}}}}}}`;let o={half_width:!1,justify_content:!1};if(e[a].control_sets[t].display_options)for(let n in e[a].control_sets[t].display_options)o[n]=e[a].control_sets[t].display_options[n];V(t,e[a].control_sets[t],n,`${a}-content`,o)}}document.querySelectorAll(".exit-modal").forEach((e=>{e.addEventListener("click",r),e.addEventListener("touchstart",r)})),document.querySelectorAll(".modal:not(.timeout-exempt)").forEach((e=>{e.addEventListener("click",l),e.addEventListener("touchstart",l)}))}(e.modals),a=e,document.querySelectorAll(".control").forEach((e=>{let t,n,r;if(e.getAttribute("data-modal"))t="modal_launcher";else{const o=e.getAttribute("data-path"),l=JSON.parse(o.replace(/<value>/,'""'));({value:n,parentObject:r}=v(l,a)),t=r.type}(t||n.value?.type)&&("stateless_mute"===t&&(e.addEventListener("click",b),e.addEventListener("touchstart",b)),"stateless_volume"===t&&e.querySelectorAll("button").forEach((e=>{e.addEventListener("click",b),e.addEventListener("touchstart",b)})),"pan_tilt"!==t&&"camera_zoom"!==t||e.querySelectorAll("button").forEach((e=>{e.addEventListener("mousedown",y),e.addEventListener("touchstart",y),e.addEventListener("mouseup",f),e.addEventListener("touchend",f)})),"modal_launcher"===t&&(e.addEventListener("click",o),e.addEventListener("touchstart",o)),"generic_toggle"===t&&E(e,n,L),"mute"===t&&O(e,n),"volume"===t&&(e.getAttribute("data-channel")&&"true"===document.querySelector(`.mute[data-channel=${e.getAttribute("data-channel")}]`).getAttribute("data-value")&&e.setAttribute("data-muted",!0),$(e,n)),"power"===t&&_(e,n),"video_mute"===t&&A(e,n),"radio"!==t&&"camera_preset_radio"!==t&&"display_source_radio"!==t&&"input_select"!==t||e.querySelectorAll(".radio-option").forEach((e=>{const a=e.getAttribute("data-option"),o=n[a].value;"display_source_radio"===t||"input_select"===t?T(e,o):E(e,o,k)})))}))}var a}async function W(e,t){if(P)return setTimeout(W(e,t),500),null;P=!0;const a={method:"PUT",body:e},n=await F(`${J}/api/systems/${N}/state`,a);return n&&t&&t(n),P=!1,n}function G(){document.getElementById("tech-errors").innerHTML="",fetch(`${J}/api/systems/${N}/cache`,{method:"delete"}).then((e=>{if(e.ok)U();else{const t=document.getElementById("alert-template").innerHTML.replace(/{{message}}/,`ERROR: ${e.status} response from ${J}/api/systems/${N}/cache`);document.getElementById("tech-errors").insertAdjacentHTML("beforeend",t)}}))}window.addEventListener("load",(async e=>{const t=new URLSearchParams(window.location.search);t.has("system")&&(N=t.get("system")),t.has("orchestrator")&&(J=t.get("orchestrator")),J||(J=await fetch("/config").then((e=>e.json())).then((e=>e.orchestrator)).catch((e=>(console.error("Could not get 'orchestrator' from server",e),null)))),J&&N||(document.getElementById("message").innerHTML="<p>System configuration not found.</p> <p>Make sure 'system' and 'orchestrator' URL parameters are set.</p>",document.getElementById("message").classList.remove("hidden")),J&&N&&(z.orchestrator=J,z.system=N,U()),document.querySelectorAll("form").forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()}))})),document.querySelectorAll(".modal:not(.timeout-exempt) .dismiss").forEach((function(e){e.addEventListener("click",r)})),document.getElementById("room-name").addEventListener("click",m),document.getElementById("maintenance").addEventListener("click",d),document.getElementById("config-reload-btn").addEventListener("click",G),document.querySelector("#maintenance .dismiss").addEventListener("click",(()=>{document.getElementById("maintenance").classList.add("hidden"),document.getElementById("tech-errors").innerHTML=""}))}))})();